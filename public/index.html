<!-- This file is not necessary for Next.js but helps with Firebase hosting redirects -->
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1"
		/>
		<title>Proper Picks</title>
		<script>
			// Process redirects
			(function () {
				// Check for general redirects from 404.html
				const redirect = sessionStorage.getItem('redirect');
				if (redirect) {
					sessionStorage.removeItem('redirect');
					if (window.location.pathname === '/') {
						history.replaceState(null, null, redirect);
					}
				}

				// Handle bracket redirects specifically
				const urlParams = new URLSearchParams(window.location.search);
				const bracketId =
					urlParams.get('redirectToBracket') ||
					sessionStorage.getItem('bracketId');

				if (bracketId) {
					sessionStorage.removeItem('bracketId');
					// Clean the URL (remove the query parameter)
					const url = new URL(window.location.href);
					url.searchParams.delete('redirectToBracket');
					history.replaceState(null, '', url);

					// Delay slightly to ensure Next.js has initialized
					setTimeout(() => {
						// This uses client-side routing when the app has loaded
						window.__NEXT_ROUTER_BASEPATH = '/';
						window.__NEXT_DATA__ = window.__NEXT_DATA__ || {};
						window.__NEXT_DATA__.query = { id: bracketId };
						window.location.href = '/brackets/view/' + bracketId;
					}, 100);
				}
			})();
		</script>
	</head>
	<body>
		<!-- This is just a fallback, Next.js will render the actual app -->
		<div id="root"></div>
	</body>
</html>
